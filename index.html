<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Девушка-воин</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #2c1810, #8b4513, #2c1810);
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }
        
        #container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #f4e4bc;
            font-size: 14px;
            z-index: 100;
            background: rgba(44, 24, 16, 0.9);
            padding: 10px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid #8b4513;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            max-width: 200px;
        }
        
        #controls {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: #f4e4bc;
            text-align: center;
            z-index: 100;
            background: rgba(44, 24, 16, 0.9);
            padding: 8px 15px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid #8b4513;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            font-size: 12px;
        }
        
        canvas {
            display: block;
            width: 100% !important;
            height: 100% !important;
        }
        
        /* Адаптивность для мобильных */
        @media (max-width: 768px) {
            #info {
                font-size: 12px;
                padding: 8px;
                max-width: 150px;
            }
            
            #controls {
                font-size: 10px;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="info">
            <div>⚔️ Девушка-воин</div>
            <div style="font-size: 10px; margin-top: 3px; opacity: 0.8;">Элитный страж</div>
        </div>
        
        <div id="controls">
            <div>Мышь: поворот • Колесико: zoom • Клик: атака</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Настройка сцены
        const scene = new THREE.Scene();
        scene.fog = new THREE.Fog(0x2c1810, 10, 30);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ 
            antialias: true, 
            alpha: false,
            powerPreference: "high-performance"
        });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x2c1810, 1);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.getElementById('container').appendChild(renderer.domElement);

        // Создание группы для всего персонажа
        const warrior = new THREE.Group();
        scene.add(warrior);

        // Материалы
        const skinMaterial = new THREE.MeshLambertMaterial({ color: 0xfdbcb4 });
        const armorMaterial = new THREE.MeshPhongMaterial({ 
            color: 0x8c7853, 
            shininess: 30,
            specular: 0x444444 
        });
        const metalMaterial = new THREE.MeshPhongMaterial({ 
            color: 0x606060, 
            shininess: 100,
            specular: 0x888888 
        });
        const hairMaterial = new THREE.MeshLambertMaterial({ color: 0x4a2c17 });
        const clothMaterial = new THREE.MeshLambertMaterial({ color: 0x8b0000 });
        
        // Переменные для анимируемых элементов
        let leftEyeWhite, rightEyeWhite, leftIris, rightIris, leftPupil, rightPupil;
        let leftStrand, rightStrand, leftEarring, rightEarring, leftChain, rightChain;

        // Создание персонажа
        function createWarrior() {
            // Голова
            const headGeometry = new THREE.SphereGeometry(0.5, 32, 32);
            const head = new THREE.Mesh(headGeometry, skinMaterial);
            head.position.y = 3.5;
            head.scale.set(1, 1.1, 0.9);
            head.castShadow = true;
            warrior.add(head);

            // Волосы
            const hairGeometry = new THREE.SphereGeometry(0.52, 24, 24);
            const hair = new THREE.Mesh(hairGeometry, hairMaterial);
            hair.position.y = 3.6;
            hair.scale.set(1.1, 1.2, 1.1);
            hair.castShadow = true;
            warrior.add(hair);

            // Пряди волос
            const strandGeometry = new THREE.CylinderGeometry(0.05, 0.08, 1.2, 8);
            leftStrand = new THREE.Mesh(strandGeometry, hairMaterial);
            leftStrand.position.set(-0.4, 3.2, 0.2);
            leftStrand.rotation.z = 0.3;
            leftStrand.castShadow = true;
            warrior.add(leftStrand);

            rightStrand = new THREE.Mesh(strandGeometry, hairMaterial);
            rightStrand.position.set(0.4, 3.2, 0.2);
            rightStrand.rotation.z = -0.3;
            rightStrand.castShadow = true;
            warrior.add(rightStrand);

            // Глаза
            const eyeWhiteGeometry = new THREE.SphereGeometry(0.08, 16, 16);
            const eyeWhiteMaterial = new THREE.MeshLambertMaterial({ color: 0xffffff });
            
            leftEyeWhite = new THREE.Mesh(eyeWhiteGeometry, eyeWhiteMaterial);
            leftEyeWhite.position.set(-0.15, 3.6, 0.42);
            leftEyeWhite.scale.set(1, 0.8, 0.6);
            warrior.add(leftEyeWhite);
            
            rightEyeWhite = new THREE.Mesh(eyeWhiteGeometry, eyeWhiteMaterial);
            rightEyeWhite.position.set(0.15, 3.6, 0.42);
            rightEyeWhite.scale.set(1, 0.8, 0.6);
            warrior.add(rightEyeWhite);

            // Радужка
            const irisGeometry = new THREE.SphereGeometry(0.04, 12, 12);
            const irisMaterial = new THREE.MeshLambertMaterial({ color: 0x2e8b57 });
            
            leftIris = new THREE.Mesh(irisGeometry, irisMaterial);
            leftIris.position.set(-0.15, 3.6, 0.45);
            warrior.add(leftIris);
            
            rightIris = new THREE.Mesh(irisGeometry, irisMaterial);
            rightIris.position.set(0.15, 3.6, 0.45);
            warrior.add(rightIris);

            // Зрачки
            const pupilGeometry = new THREE.SphereGeometry(0.02, 8, 8);
            const pupilMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 });
            
            leftPupil = new THREE.Mesh(pupilGeometry, pupilMaterial);
            leftPupil.position.set(-0.15, 3.6, 0.46);
            warrior.add(leftPupil);
            
            rightPupil = new THREE.Mesh(pupilGeometry, pupilMaterial);
            rightPupil.position.set(0.15, 3.6, 0.46);
            warrior.add(rightPupil);

            // Ресницы
            const lashGeometry = new THREE.CylinderGeometry(0.002, 0.001, 0.08, 4);
            const lashMaterial = new THREE.MeshBasicMaterial({ color: 0x2c1810 });
            
            for (let i = 0; i < 6; i++) {
                const lash = new THREE.Mesh(lashGeometry, lashMaterial);
                const angle = (i - 2.5) * 0.15;
                lash.position.set(-0.15 + Math.sin(angle) * 0.08, 3.68, 0.47);
                lash.rotation.z = angle;
                lash.rotation.x = -0.3;
                warrior.add(lash);
            }
            
            for (let i = 0; i < 6; i++) {
                const lash = new THREE.Mesh(lashGeometry, lashMaterial);
                const angle = (i - 2.5) * 0.15;
                lash.position.set(0.15 + Math.sin(angle) * 0.08, 3.68, 0.47);
                lash.rotation.z = angle;
                lash.rotation.x = -0.3;
                warrior.add(lash);
            }

            // Брови с волосками
            const browHairGeometry = new THREE.CylinderGeometry(0.002, 0.001, 0.06, 4);
            const browHairMaterial = new THREE.MeshLambertMaterial({ color: 0x3a2317 });
            
            for (let i = 0; i < 8; i++) {
                const browHair = new THREE.Mesh(browHairGeometry, browHairMaterial);
                browHair.position.set(-0.22 + i * 0.012, 3.75 + Math.random() * 0.02, 0.42);
                browHair.rotation.z = 0.3 + (Math.random() - 0.5) * 0.4;
                browHair.rotation.x = -0.2;
                warrior.add(browHair);
            }
            
            for (let i = 0; i < 8; i++) {
                const browHair = new THREE.Mesh(browHairGeometry, browHairMaterial);
                browHair.position.set(0.08 + i * 0.012, 3.75 + Math.random() * 0.02, 0.42);
                browHair.rotation.z = -0.3 + (Math.random() - 0.5) * 0.4;
                browHair.rotation.x = -0.2;
                warrior.add(browHair);
            }

            // Нос
            const noseGeometry = new THREE.ConeGeometry(0.06, 0.15, 8);
            const nose = new THREE.Mesh(noseGeometry, skinMaterial);
            nose.position.set(0, 3.5, 0.45);
            nose.rotation.x = Math.PI;
            warrior.add(nose);

            // Ноздри
            const nostrilGeometry = new THREE.SphereGeometry(0.015, 6, 6);
            const nostrilMaterial = new THREE.MeshLambertMaterial({ color: 0xd4a574 });
            
            const leftNostril = new THREE.Mesh(nostrilGeometry, nostrilMaterial);
            leftNostril.position.set(-0.03, 3.45, 0.48);
            warrior.add(leftNostril);
            
            const rightNostril = new THREE.Mesh(nostrilGeometry, nostrilMaterial);
            rightNostril.position.set(0.03, 3.45, 0.48);
            warrior.add(rightNostril);

            // Губы
            const lipGeometry = new THREE.SphereGeometry(0.12, 16, 8);
            const lipMaterial = new THREE.MeshLambertMaterial({ color: 0xcd5c5c });
            const lips = new THREE.Mesh(lipGeometry, lipMaterial);
            lips.position.set(0, 3.25, 0.43);
            lips.scale.set(1, 0.3, 0.8);
            warrior.add(lips);

            // Скулы
            const cheekGeometry = new THREE.SphereGeometry(0.12, 12, 12);
            const cheekMaterial = new THREE.MeshLambertMaterial({ color: 0xf2c2a7 });
            
            const leftCheek = new THREE.Mesh(cheekGeometry, cheekMaterial);
            leftCheek.position.set(-0.25, 3.4, 0.3);
            leftCheek.scale.set(0.8, 0.6, 0.6);
            warrior.add(leftCheek);
            
            const rightCheek = new THREE.Mesh(cheekGeometry, cheekMaterial);
            rightCheek.position.set(0.25, 3.4, 0.3);
            rightCheek.scale.set(0.8, 0.6, 0.6);
            warrior.add(rightCheek);

            // Уши
            const earGeometry = new THREE.SphereGeometry(0.08, 12, 12);
            const earMaterial = new THREE.MeshLambertMaterial({ color: 0xf0b895 });
            
            const leftEar = new THREE.Mesh(earGeometry, earMaterial);
            leftEar.position.set(-0.45, 3.5, 0.1);
            leftEar.scale.set(0.6, 1, 0.4);
            warrior.add(leftEar);
            
            const rightEar = new THREE.Mesh(earGeometry, earMaterial);
            rightEar.position.set(0.45, 3.5, 0.1);
            rightEar.scale.set(0.6, 1, 0.4);
            warrior.add(rightEar);

            // Серьги
            const earringGeometry = new THREE.SphereGeometry(0.04, 8, 8);
            const earringMaterial = new THREE.MeshPhongMaterial({ 
                color: 0xffd700, 
                shininess: 100 
            });
            
            leftEarring = new THREE.Mesh(earringGeometry, earringMaterial);
            leftEarring.position.set(-0.52, 3.35, 0.1);
            leftEarring.castShadow = true;
            warrior.add(leftEarring);
            
            rightEarring = new THREE.Mesh(earringGeometry, earringMaterial);
            rightEarring.position.set(0.52, 3.35, 0.1);
            rightEarring.castShadow = true;
            warrior.add(rightEarring);

            // Цепочки от серёг
            const chainGeometry = new THREE.CylinderGeometry(0.005, 0.005, 0.15, 6);
            const chainMaterial = new THREE.MeshPhongMaterial({ color: 0xffd700 });
            
            leftChain = new THREE.Mesh(chainGeometry, chainMaterial);
            leftChain.position.set(-0.52, 3.425, 0.1);
            warrior.add(leftChain);
            
            rightChain = new THREE.Mesh(chainGeometry, chainMaterial);
            rightChain.position.set(0.52, 3.425, 0.1);
            warrior.add(rightChain);

            // Боевая раскраска
            const warPaintGeometry = new THREE.BoxGeometry(0.08, 0.25, 0.002);
            const warPaintMaterial = new THREE.MeshBasicMaterial({ color: 0x8b0000 });
            
            const leftWarPaint = new THREE.Mesh(warPaintGeometry, warPaintMaterial);
            leftWarPaint.position.set(-0.15, 3.45, 0.48);
            warrior.add(leftWarPaint);
            
            const rightWarPaint = new THREE.Mesh(warPaintGeometry, warPaintMaterial);
            rightWarPaint.position.set(0.15, 3.45, 0.48);
            warrior.add(rightWarPaint);

            // Шея
            const neckGeometry = new THREE.CylinderGeometry(0.2, 0.25, 0.4, 12);
            const neck = new THREE.Mesh(neckGeometry, skinMaterial);
            neck.position.y = 2.9;
            neck.castShadow = true;
            warrior.add(neck);

            // Туловище
            const torsoGeometry = new THREE.CylinderGeometry(0.6, 0.8, 1.5, 12);
            const torso = new THREE.Mesh(torsoGeometry, armorMaterial);
            torso.position.y = 2;
            torso.castShadow = true;
            warrior.add(torso);

            // Нагрудная пластина
            const chestPlateGeometry = new THREE.BoxGeometry(1.2, 1.2, 0.2);
            const chestPlate = new THREE.Mesh(chestPlateGeometry, metalMaterial);
            chestPlate.position.set(0, 2.2, 0.3);
            chestPlate.castShadow = true;
            warrior.add(chestPlate);

            // Руки
            const armGeometry = new THREE.CylinderGeometry(0.15, 0.2, 1.2, 8);
            
            const leftArm = new THREE.Mesh(armGeometry, armorMaterial);
            leftArm.position.set(-0.9, 2, 0);
            leftArm.rotation.z = 0.3;
            leftArm.castShadow = true;
            warrior.add(leftArm);
            
            const rightArm = new THREE.Mesh(armGeometry, armorMaterial);
            rightArm.position.set(0.9, 2, 0);
            rightArm.rotation.z = -0.3;
            rightArm.castShadow = true;
            warrior.add(rightArm);

            // Плечевые доспехи
            const shoulderGeometry = new THREE.SphereGeometry(0.35, 12, 12);
            
            const leftShoulder = new THREE.Mesh(shoulderGeometry, metalMaterial);
            leftShoulder.position.set(-0.7, 2.5, 0);
            leftShoulder.scale.set(1.2, 0.8, 1.2);
            leftShoulder.castShadow = true;
            warrior.add(leftShoulder);
            
            const rightShoulder = new THREE.Mesh(shoulderGeometry, metalMaterial);
            rightShoulder.position.set(0.7, 2.5, 0);
            rightShoulder.scale.set(1.2, 0.8, 1.2);
            rightShoulder.castShadow = true;
            warrior.add(rightShoulder);

            // Ноги
            const legGeometry = new THREE.CylinderGeometry(0.18, 0.22, 1.8, 8);
            
            const leftLeg = new THREE.Mesh(legGeometry, armorMaterial);
            leftLeg.position.set(-0.3, 0.3, 0);
            leftLeg.castShadow = true;
            warrior.add(leftLeg);
            
            const rightLeg = new THREE.Mesh(legGeometry, armorMaterial);
            rightLeg.position.set(0.3, 0.3, 0);
            rightLeg.castShadow = true;
            warrior.add(rightLeg);

            // Меч
            const swordHandleGeometry = new THREE.CylinderGeometry(0.05, 0.05, 0.8, 8);
            const swordHandle = new THREE.Mesh(swordHandleGeometry, new THREE.MeshPhongMaterial({ color: 0x4a4a4a }));
            swordHandle.position.set(1.5, 1.5, 0);
            swordHandle.castShadow = true;
            warrior.add(swordHandle);

            const swordBladeGeometry = new THREE.BoxGeometry(0.1, 2, 0.05);
            const swordBlade = new THREE.Mesh(swordBladeGeometry, new THREE.MeshPhongMaterial({ 
                color: 0xc0c0c0, 
                shininess: 100,
                specular: 0xffffff 
            }));
            swordBlade.position.set(1.5, 2.5, 0);
            swordBlade.castShadow = true;
            warrior.add(swordBlade);

            // Щит
            const shieldGeometry = new THREE.CylinderGeometry(0.6, 0.6, 0.1, 12);
            const shield = new THREE.Mesh(shieldGeometry, new THREE.MeshPhongMaterial({ 
                color: 0x8b0000,
                shininess: 50 
            }));
            shield.position.set(-1.2, 1.8, 0);
            shield.rotation.z = Math.PI / 2;
            shield.castShadow = true;
            warrior.add(shield);

            // Плащ
            const capeGeometry = new THREE.CylinderGeometry(0.1, 1.2, 2, 12, 1, true);
            const cape = new THREE.Mesh(capeGeometry, clothMaterial);
            cape.position.set(0, 1.5, -0.8);
            cape.castShadow = true;
            warrior.add(cape);

            // Корона
            const crownGeometry = new THREE.CylinderGeometry(0.52, 0.48, 0.2, 12);
            const crown = new THREE.Mesh(crownGeometry, new THREE.MeshPhongMaterial({ 
                color: 0xffd700,
                shininess: 100 
            }));
            crown.position.y = 4;
            crown.castShadow = true;
            warrior.add(crown);
        }

        // Создаем персонажа
        createWarrior();

        // Освещение
        const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 10, 5);
        directionalLight.castShadow = true;
        directionalLight.shadow.mapSize.width = 1024;
        directionalLight.shadow.mapSize.height = 1024;
        scene.add(directionalLight);

        const pointLight = new THREE.PointLight(0xff6b35, 0.6);
        pointLight.position.set(-5, 5, 5);
        scene.add(pointLight);

        // Пол
        const floorGeometry = new THREE.PlaneGeometry(20, 20);
        const floorMaterial = new THREE.MeshLambertMaterial({ color: 0x2c1810 });
        const floor = new THREE.Mesh(floorGeometry, floorMaterial);
        floor.rotation.x = -Math.PI / 2;
        floor.position.y = -1;
        floor.receiveShadow = true;
        scene.add(floor);

        // Позиция камеры
        camera.position.set(0, 3, 8);
        camera.lookAt(0, 2, 0);

        // Переменные для управления
        let mouseX = 0, mouseY = 0;
        let targetRotationX = 0, targetRotationY = 0;
        let mouseDown = false;
        let isAnimating = false;

        // Обработчики событий
        function onMouseDown(event) {
            event.preventDefault();
            mouseDown = true;
            mouseX = event.clientX || event.touches[0].clientX;
            mouseY = event.clientY || event.touches[0].clientY;
        }

        function onMouseUp(event) {
            event.preventDefault();
            mouseDown = false;
        }

        function onMouseMove(event) {
            event.preventDefault();
            if (mouseDown) {
                const clientX = event.clientX || event.touches[0].clientX;
                const clientY = event.clientY || event.touches[0].clientY;
                
                const deltaX = clientX - mouseX;
                const deltaY = clientY - mouseY;
                
                targetRotationY += deltaX * 0.01;
                targetRotationX += deltaY * 0.01;
                targetRotationX = Math.max(-Math.PI/3, Math.min(Math.PI/3, targetRotationX));
                
                mouseX = clientX;
                mouseY = clientY;
            }
        }

        function onWheel(event) {
            event.preventDefault();
            camera.position.z += event.deltaY * 0.01;
            camera.position.z = Math.max(4, Math.min(15, camera.position.z));
        }

        function onClick() {
            if (!isAnimating) {
                isAnimating = true;
                setTimeout(() => isAnimating = false, 2000);
            }
        }

        // Добавляем обработчики
        renderer.domElement.addEventListener('mousedown', onMouseDown);
        renderer.domElement.addEventListener('mouseup', onMouseUp);
        renderer.domElement.addEventListener('mousemove', onMouseMove);
        renderer.domElement.addEventListener('wheel', onWheel);
        renderer.domElement.addEventListener('click', onClick);

        // Сенсорные события
        renderer.domElement.addEventListener('touchstart', onMouseDown);
        renderer.domElement.addEventListener('touchend', onMouseUp);
        renderer.domElement.addEventListener('touchmove', onMouseMove);

        // Анимационный цикл
        function animate() {
            requestAnimationFrame(animate);
            
            // Плавное вращение
            warrior.rotation.x += (targetRotationX - warrior.rotation.x) * 0.1;
            warrior.rotation.y += (targetRotationY - warrior.rotation.y) * 0.1;
            
            // Анимация моргания
            const blinkTime = Date.now() * 0.005;
            if (Math.sin(blinkTime) > 0.98) {
                leftEyeWhite.scale.y = 0.1;
                rightEyeWhite.scale.y = 0.1;
                leftIris.scale.y = 0.1;
                rightIris.scale.y = 0.1;
                leftPupil.scale.y = 0.1;
                rightPupil.scale.y = 0.1;
            } else {
                leftEyeWhite.scale.y = 0.8;
                rightEyeWhite.scale.y = 0.8;
                leftIris.scale.y = 1;
                rightIris.scale.y = 1;
                leftPupil.scale.y = 1;
                rightPupil.scale.y = 1;
            }
            
            // Движение волос
            leftStrand.rotation.z = 0.3 + Math.sin(Date.now() * 0.002) * 0.1;
            rightStrand.rotation.z = -0.3 + Math.sin(Date.now() * 0.0025) * 0.1;
            
            // Анимация серёжек
            const swayTime = Date.now() * 0.003;
            leftEarring.rotation.z = Math.sin(swayTime) * 0.1;
            rightEarring.rotation.z = Math.sin(swayTime + 0.5) * 0.1;
            leftChain.rotation.z = Math.sin(swayTime) * 0.05;
            rightChain.rotation.z = Math.sin(swayTime + 0.5) * 0.05;
            
            // Автоматическое вращение
            if (!mouseDown && !isAnimating) {
                targetRotationY += 0.002;
            }
            
            renderer.render(scene, camera);
        }

        // Обработка изменения размера
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        window.addEventListener('resize', onWindowResize);

        // Запуск
        animate();

        // Начальная анимация появления
        warrior.scale.set(0, 0, 0);
        function startAnimation() {
            const scale = warrior.scale.x;
            if (scale < 1) {
                warrior.scale.set(scale + 0.02, scale + 0.02, scale + 0.02);
                requestAnimationFrame(startAnimation);
            }
        }
        startAnimation();
    </script>
</body>
</html>
